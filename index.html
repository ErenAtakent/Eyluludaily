<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EylÃ¼lÃ¼ Daily ğŸ¤</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: linear-gradient(to bottom, #e3eaf2, #dfe3e6);
      color: #2e3b4e;
    }
    .container {
      max-width: 900px;
      margin: 30px auto;
      background: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.1);
    }
    h1, h2 {
      text-align: center;
      color: #3f51b5;
    }
    .progress-bar, .love-bar {
      width: 100%;
      background: #d0d0d0;
      border-radius: 20px;
      overflow: hidden;
      margin: 20px 0;
    }
    .progress-bar-inner, .love-bar-inner {
      height: 25px;
      background: linear-gradient(to right, #3f51b5, #7986cb);
      color: white;
      text-align: right;
      padding-right: 10px;
      line-height: 25px;
      font-weight: bold;
      transition: width 0.5s;
    }
    input[type="text"], textarea {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    button {
      background: #3f51b5;
      color: white;
      border: none;
      padding: 10px 20px;
      margin-top: 10px;
      border-radius: 10px;
      cursor: pointer;
    }
    ul {
      list-style: none; padding: 0;
    }
    li {
      background: #f0f0f0;
      padding: 10px;
      border-radius: 10px;
      margin: 10px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    li.completed span {
      text-decoration: line-through;
      color: #888;
    }
    .emoji-cell {
      font-size: 24px;
      padding: 6px;
      cursor: pointer;
    }
    .day-plan {
      background: #f4f7fa;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
    }
    .hidden {
      display: none;
    }
    .login-box {
      max-width: 400px;
      margin: 100px auto;
      padding: 30px;
      background: white;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
      text-align: center;
    }
    .emoji-row {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
    }
    audio {
      width: 100%;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<!-- GiriÅŸ ekranÄ± -->
<div class="login-box" id="loginBox">
  <h2>ğŸ”’ EylÃ¼lÃ¼ Daily</h2>
  <input type="password" id="passwordInput" placeholder="Åifre: 03032025" />
  <br/>
  <button onclick="checkPassword()">GiriÅŸ Yap</button>
  <p id="error" style="color:red; display:none;">Åifre yanlÄ±ÅŸ ğŸ˜¢</p>
</div>

<!-- Ana iÃ§erik -->
<div class="container hidden" id="mainContent">
  <h1>HoÅŸ geldin EylÃ¼l ğŸ¤</h1>
  <h2>â³ <span id="timeTogether"></span></h2>

  <h2>6 AylÄ±k Hedef BarÄ±</h2>
  <div class="progress-bar">
    <div class="progress-bar-inner" id="progressBar"></div>
  </div>

  <h2>â¤ï¸ Sevgi BarÄ±</h2>
  <div class="love-bar">
    <div class="love-bar-inner" id="loveBar">0%</div>
  </div>
  <!-- YapÄ±lacaklar Listesi -->
  <h2>ğŸ“ YapÄ±lacaklar</h2>
  <input type="text" id="todoInput" placeholder="Yeni gÃ¶rev ekle..."/>
  <button onclick="addTodo()">Ekle</button>
  <ul id="todoList"></ul>

  <!-- Emoji Takvimi -->
  <h2>ğŸ˜Š Ortak Duygu Emoji Takvimi</h2>
  <div id="emojiCalendar" class="emoji-row"></div>

  <!-- HaftalÄ±k PlanlayÄ±cÄ± -->
  <h2>ğŸ“… HaftalÄ±k PlanlayÄ±cÄ±</h2>
  <div id="planner"></div>

  <!-- Zaman KapsÃ¼lÃ¼ -->
  <h2>ğŸ“¦ Zaman KapsÃ¼lÃ¼</h2>
  <textarea id="timeCapsuleInput" rows="3" placeholder="GeleceÄŸe mesajÄ±nÄ± yaz..."></textarea><br/>
  <label for="capsuleDate">AÃ§Ä±lma Tarihi: </label>
  <input type="date" id="capsuleDate"/><br/>
  <button onclick="saveTimeCapsule()">Zaman KapsÃ¼lÃ¼nÃ¼ Kaydet</button>
  <p id="capsuleMessage" style="margin-top:10px; font-style: italic;"></p>

  <!-- Sesli Not -->
  <h2>ğŸ™ï¸ Sesli Not</h2>
  <button id="recordBtn">ğŸ¤ Kayda BaÅŸla</button>
  <button id="stopBtn" disabled>â–  KaydÄ± Durdur</button>
  <audio id="audioPlayback" controls></audio>

</div> <!-- container ve mainContent sonu -->

<script>
  // Åifre kontrolÃ¼
  const PASSWORD = "03032025";
  function checkPassword() {
    const val = document.getElementById("passwordInput").value;
    if (val === PASSWORD) {
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("mainContent").classList.remove("hidden");
      initializeApp();
    } else {
      document.getElementById("error").style.display = "block";
    }
  }

  // DeÄŸiÅŸkenler
  let todos = JSON.parse(localStorage.getItem("todos") || "[]");
  let emojis = JSON.parse(localStorage.getItem("emojis") || "{}");
  let plans = JSON.parse(localStorage.getItem("plans") || "{}");
  let timeCapsule = JSON.parse(localStorage.getItem("timeCapsule") || "{}");

  // BaÅŸlangÄ±Ã§ tarihi (3 Mart 2025)
  const startDate = new Date(2025, 2, 3);

  // Zaman kapsÃ¼lÃ¼nÃ¼n aÃ§Ä±lÄ±p aÃ§Ä±lmadÄ±ÄŸÄ±nÄ± kontrol et
  function checkTimeCapsule() {
    const now = new Date();
    const openDate = timeCapsule.openDate ? new Date(timeCapsule.openDate) : null;
    const messageEl = document.getElementById("capsuleMessage");
    if (openDate && now >= openDate && timeCapsule.message) {
      messageEl.textContent = "Zaman KapsÃ¼lÃ¼n AÃ§Ä±ldÄ± ğŸ’Œ: " + timeCapsule.message;
    } else {
      messageEl.textContent = "";
    }
  }

  // Zaman kapsÃ¼lÃ¼ kaydet
  function saveTimeCapsule() {
    const message = document.getElementById("timeCapsuleInput").value.trim();
    const openDate = document.getElementById("capsuleDate").value;
    if (!message || !openDate) {
      alert("LÃ¼tfen mesaj ve aÃ§Ä±lma tarihini doldur.");
      return;
    }
    timeCapsule = { message, openDate };
    localStorage.setItem("timeCapsule", JSON.stringify(timeCapsule));
    checkTimeCapsule();
    alert("Zaman kapsÃ¼lÃ¼nÃ¼z kaydedildi!");
  }

  // YapÄ±lacaklar listesi fonksiyonlarÄ±
  function addTodo() {
    const input = document.getElementById("todoInput");
    const val = input.value.trim();
    if (!val) return;
    todos.push({ text: val, done: false });
    input.value = "";
    saveTodos();
    renderTodos();
    updateLoveBar();
  }

  function renderTodos() {
    const list = document.getElementById("todoList");
    list.innerHTML = "";
    todos.forEach((todo, i) => {
      const li = document.createElement("li");
      li.className = todo.done ? "completed" : "";

      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.checked = todo.done;
      checkbox.onchange = () => {
        todos[i].done = checkbox.checked;
        saveTodos();
        renderTodos();
        updateLoveBar();
      };

      const label = document.createElement("span");
      label.textContent = todo.text;

      const del = document.createElement("button");
      del.textContent = "âŒ";
      del.onclick = () => {
        if (confirm("Emin misin EylÃ¼lÃ¼? ğŸ¥º")) {
          todos.splice(i, 1);
          saveTodos();
          renderTodos();
          updateLoveBar();
        }
      };

      li.appendChild(checkbox);
      li.appendChild(label);
      li.appendChild(del);
      list.appendChild(li);
    });
  }

  function saveTodos() {
    localStorage.setItem("todos", JSON.stringify(todos));
  }

  // Emoji takvimi fonksiyonlarÄ±
  const emojiOptions = ["ğŸ˜Š","ğŸ˜","ğŸ˜‚","ğŸ˜¢","ğŸ˜¡","ğŸ˜´","ğŸ¥°","ğŸ¤—","ğŸ˜","ğŸ¤©"];

  function renderEmojiCalendar() {
    const container = document.getElementById("emojiCalendar");
    container.innerHTML = "";
    // HaftanÄ±n gÃ¼nleri: Pazartesi'den Pazar'a
    const days = ["Pzt", "Sal", "Ã‡ar", "Per", "Cum", "Cmt", "Paz"];
    days.forEach((day, i) => {
      const cell = document.createElement("div");
      cell.className = "emoji-cell";
      cell.title = day;
      cell.textContent = emojis[i] || "â•";
      cell.onclick = () => {
        showEmojiPicker(i);
      };
      container.appendChild(cell);
    });
  }

  function showEmojiPicker(dayIndex) {
    const choice = prompt("Emoji seÃ§ (Ã¶rnek: ğŸ˜Š, ğŸ˜, ğŸ˜‚):", emojis[dayIndex] || "");
    if (choice && emojiOptions.includes(choice)) {
      emojis[dayIndex] = choice;
      localStorage.setItem("emojis", JSON.stringify(emojis));
      renderEmojiCalendar();
    } else if (choice !== null) {
      alert("LÃ¼tfen geÃ§erli bir emoji seÃ§in!");
    }
  }

  // PlanlayÄ±cÄ± fonksiyonlarÄ±
  function renderPlanner() {
    const container = document.getElementById("planner");
    container.innerHTML = "";
    const days = ["Pazartesi","SalÄ±","Ã‡arÅŸamba","PerÅŸembe","Cuma","Cumartesi","Pazar"];
    days.forEach((day, i) => {
      const box = document.createElement("div");
      box.className = "day-plan";

      const title = document.createElement("h3");
      title.textContent = day;

      const textarea = document.createElement("textarea");
      textarea.placeholder = `${day} iÃ§in not...`;
      textarea.value = plans[i] || "";
      textarea.oninput = () => {
        plans[i] = textarea.value;
        localStorage.setItem("plans", JSON.stringify(plans));
        updateLoveBar();
      };

      box.appendChild(title);
      box.appendChild(textarea);
      container.appendChild(box);
    });
  }

  // Sevgi BarÄ± hesaplama (Ã¶rnek basit algoritma)
  function updateLoveBar() {
    // YapÄ±lacaklar tamamlanma oranÄ± %50, planlayÄ±cÄ± doluluk oranÄ± %50
    let todoRatio = todos.length === 0 ? 0 : (todos.filter(t => t.done).length / todos.length);
    let planFilled = Object.values(plans).filter(v => v.trim() !== "").length;
    let planRatio = planFilled / 7;
    let score = Math.round( (todoRatio * 0.5 + planRatio * 0.5) * 100 );
    if(score > 100) score = 100;

    const loveBar = document.getElementById("loveBar");
    loveBar.style.width = score + "%";
    loveBar.textContent = score + "%";
  }

  // Birlikte geÃ§en sÃ¼re dinamik hesaplama
  function updateTimeTogether() {
    const now = new Date();
    let diff = now - startDate;
    if(diff < 0) diff = 0;

    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
    const minutes = Math.floor((diff / (1000 * 60)) % 60);
    const seconds = Math.floor((diff / 1000) % 60);

    const el = document.getElementById("timeTogether");
    el.textContent = `BeraberliÄŸimiz: ${days} gÃ¼n, ${hours} saat, ${minutes} dakika, ${seconds} saniye`;
  }

  // Sesli Not KaydÄ± (basit ve yerel)
  let mediaRecorder;
  let audioChunks = [];

  const recordBtn = document.getElementById("recordBtn");
  const stopBtn = document.getElementById("stopBtn");
  const audioPlayback = document.getElementById("audioPlayback");

  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
    recordBtn.onclick = async () => {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      mediaRecorder.start();
      audioChunks = [];

      mediaRecorder.ondataavailable = e => {
        audioChunks.push(e.data);
      };

      mediaRecorder.onstop = e => {
        const audioBlob = new Blob(audioChunks);
        const audioUrl = URL.createObjectURL(audioBlob);
        audioPlayback.src = audioUrl;
        // KaydÄ± localStorage'a base64 ile kaydetmek mÃ¼mkÃ¼n ama genelde Ã¶nerilmez (bÃ¼yÃ¼k boyut)
      };

      recordBtn.disabled = true;
      stopBtn.disabled = false;
    };

    stopBtn.onclick = () => {
      mediaRecorder.stop();
      recordBtn.disabled = false;
      stopBtn.disabled = true;
    };
  } else {
    recordBtn.disabled = true;
    stopBtn.disabled = true;
    recordBtn.textContent = "ğŸ¤ Desteklenmiyor";
  }

  // Ana uygulama baÅŸlat
  function initializeApp() {
    renderTodos();
    renderEmojiCalendar();
    renderPlanner();
    checkTimeCapsule();
    updateLoveBar();
    updateTimeTogether();
    setInterval(updateTimeTogether, 1000);
  }
</script>
</body>
</html>
